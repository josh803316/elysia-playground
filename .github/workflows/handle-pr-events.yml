name: Handle PR Events

on:
  pull_request_review:
    types: [submitted]
  pull_request:
    types: [converted_to_draft, ready_for_review]

jobs:
  handle-pr-event:
    uses: videate/shared-ci-workflows/.github/workflows/pr-review-handler.yml@main
    with:
      event_type: ${{ github.event_name == 'pull_request_review' && 'PR_REVIEW_SUBMITTED' || github.event.pull_request.draft && 'PR_DRAFT' || 'PR_READY' }}
      review_state: ${{ github.event.review.state }}
      pr_number: ${{ github.event.pull_request.number }}
      pr_author: ${{ github.event.pull_request.user.login }}
      pr_author_email: ${{ github.event.pull_request.user.email }}
      remaining_reviewers: ${{ github.event.pull_request.requested_reviewers.length }}
      reviewer: ${{ github.event.review.user.login }}
    secrets: inherit
